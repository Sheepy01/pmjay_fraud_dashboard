{% extends 'base.html' %}
{% load static %}

{% block title %}Data Management{% endblock %}

{% block head_extra %}
  
{% endblock %}

{% block content %}
<div class="data-management-container">
  <div class="upload-section">
    <!-- Suspicious Hospitals Card -->
    <div class="upload-card" id="suspiciousHospitalCard">
      <div class="preview-container" style="display:none;"></div>
      <h3>Suspicious Hospital List</h3>
        {% with history=file_upload_histories.suspicious %}
          <div class="file-info">
            {% if history %}
              <span class="file-name">
                {{ history.filename }} (uploaded at {{ history.uploaded_at|date:"Y-m-d H:i" }})
              </span>
            {% else %}
              <span class="file-name">No file uploaded</span>
            {% endif %}

            <div class="file-actions">
              <input type="file" class="file-input" data-model="suspicious" accept=".xlsx,.xls" hidden>
              <button class="upload-btn btn-glow">
                <i class="fas fa-upload"></i> Upload
              </button>
              <button
                class="view-btn btn-glow"
                {% if not history %}disabled{% endif %}
              >
                <i class="fas fa-eye"></i> View
              </button>
            </div>
          </div>
        {% endwith %}
        <div class="progress-container">
            <div class="progress-bar"></div>
        </div>
    </div>

    <!-- Hospital Beds Card -->
    <div class="upload-card" id="hospitalBedsCard">
        <div class="preview-container" style="display:none;"></div>
        <h3>Hospital Beds</h3>
        {% with history=file_upload_histories.beds %}
          <div class="file-info">
            {% if history %}
              <span class="file-name">
                {{ history.filename }} (uploaded at {{ history.uploaded_at|date:"Y-m-d H:i" }})
              </span>
            {% else %}
              <span class="file-name">No file uploaded</span>
            {% endif %}

            <div class="file-actions">
              <input type="file" class="file-input" data-model="beds" accept=".xlsx,.xls" hidden>
              <button class="upload-btn btn-glow">
                <i class="fas fa-upload"></i> Upload
              </button>
              <button
                class="view-btn btn-glow"
                {% if not history %}disabled{% endif %}>
                <i class="fas fa-eye"></i> View
              </button>
            </div>
          </div>
        {% endwith %}
        <div class="progress-container">
            <div class="progress-bar"></div>
        </div>
    </div>
  </div>
</div>

<!-- Data View Modal -->
<div id="dataModal" class="modal">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title"></h3>
        <button class="close-btn">&times;</button>
      </div>
      <div class="modal-body" id="modalTableContent">
        <!-- Table will be inserted here -->
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
  <script src="{% static 'js/data_management.js' %}"></script>
{% endblock %}